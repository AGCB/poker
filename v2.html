<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Poker app from ScratchV2</title>
  </head>
  <body>
<script>
  console.log('app is running');
  /*
    The first version dealt with a poker table with 3 people. This time we will
    make it a table of 10.

    We start a game....
    there will be an object called TABLE.
    every seat will have the following info.
    seatNumber, playerName, chipTotal, potContribution, firstCard,
    secondCard, dealerChip
     */
     var dealer = [];
     var nonGarbageCards = [];
     var pot = 0;
     var playerOrder = [];
     var playerOrderToDeal = [];
     var dealerSeatNumber;
     var table = [
      {  seatNumber: 1,
         playerName: 'jim',
         chipTotal: 100,
         potContribution: 0,
         firstCard: undefined,
         secondCard: undefined,
         dealerChip: false,
         inCurrentGame: false},

      {  seatNumber: 2,
         playerName: 'alex',
         chipTotal: 100,
         potContribution: 0,
         firstCard: undefined,
         secondCard: undefined,
         dealerChip: false,
         inCurrentGame: false},

         {  seatNumber: 3,
            playerName: 'steve',
            chipTotal: 100,
            potContribution: 0,
            firstCard: undefined,
            secondCard: undefined,
            dealerChip: true,
            inCurrentGame: false},

            {  seatNumber: 4,
               playerName: 'gary',
               chipTotal: 100,
               potContribution: 0,
               firstCard: undefined,
               secondCard: undefined,
               dealerChip: false,
               inCurrentGame: false},

               {  seatNumber: 5,
                  playerName: 'david',
                  chipTotal: 100,
                  potContribution: 0,
                  firstCard: undefined,
                  secondCard: undefined,
                  dealerChip: false,
                  inCurrentGame: false},

                  {  seatNumber: 6,
                     playerName: 'josh',
                     chipTotal: 100,
                     potContribution: 0,
                     firstCard: undefined,
                     secondCard: undefined,
                     dealerChip: false,
                     inCurrentGame: false},

                     {  seatNumber: 7,
                        playerName: 'tommy',
                        chipTotal: 100,
                        potContribution: 0,
                        firstCard: undefined,
                        secondCard: undefined,
                        dealerChip: false,
                        inCurrentGame: false},

                        {  seatNumber: 8,
                           playerName: 'jerry',
                           chipTotal: 100,
                           potContribution: 0,
                           firstCard: undefined,
                           secondCard: undefined,
                           dealerChip: false,
                           inCurrentGame: false},

                           {  seatNumber: 9,
                              playerName: 'marsel',
                              chipTotal: 100,
                              potContribution: 0,
                              firstCard: undefined,
                              secondCard: undefined,
                              dealerChip: false,
                              inCurrentGame: false},

                              {  seatNumber: 10,
                                 playerName: "sally",
                                 chipTotal: 0,
                                 potContribution: 0,
                                 firstCard: undefined,
                                 secondCard: undefined,
                                 dealerChip: false,
                                 inCurrentGame: false},

     ]

  var deckOfCards = [
    {number: "2",
     suit: "diamonds"},
    {number: "3",
     suit: "diamonds"},
    {number: "4",
     suit: "diamonds"},
    {number: "5",
     suit: "diamonds"},
    {number: "6",
     suit: "diamonds"},
    {number: "7",
     suit: "diamonds"},
    {number: "8",
     suit: "diamonds"},
    {number: "9",
     suit: "diamonds"},
    {number: "10",
     suit: "diamonds"},
    {number: "jack",
     suit: "diamonds"},
    {number: "queen",
     suit: "diamonds"},
    {number: "king",
     suit: "diamonds"},
    {number: "ace",
     suit: "diamonds"},

     {number: "2",
      suit: "spades"},
     {number: "3",
      suit: "spades"},
     {number: "4",
      suit: "spades"},
     {number: "5",
      suit: "spades"},
     {number: "6",
      suit: "spades"},
     {number: "7",
      suit: "spades"},
     {number: "8",
      suit: "spades"},
     {number: "9",
      suit: "spades"},
     {number: "10",
      suit: "spades"},
     {number: "jack",
      suit: "spades"},
     {number: "queen",
      suit: "spades"},
     {number: "king",
      suit: "spades"},
     {number: "ace",
      suit: "spades"},

      {number: "2",
       suit: "clubs"},
      {number: "3",
       suit: "clubs"},
      {number: "4",
       suit: "clubs"},
      {number: "5",
       suit: "clubs"},
      {number: "6",
       suit: "clubs"},
      {number: "7",
       suit: "clubs"},
      {number: "8",
       suit: "clubs"},
      {number: "9",
       suit: "clubs"},
      {number: "10",
       suit: "clubs"},
      {number: "jack",
       suit: "clubs"},
      {number: "queen",
       suit: "clubs"},
      {number: "king",
       suit: "clubs"},
      {number: "ace",
       suit: "clubs"},

       {number: "2",
        suit: "hearts"},
       {number: "3",
        suit: "hearts"},
       {number: "4",
        suit: "hearts"},
       {number: "5",
        suit: "hearts"},
       {number: "6",
        suit: "hearts"},
       {number: "7",
        suit: "hearts"},
       {number: "8",
        suit: "hearts"},
       {number: "9",
        suit: "hearts"},
       {number: "10",
        suit: "hearts"},
       {number: "jack",
        suit: "hearts"},
       {number: "queen",
        suit: "hearts"},
       {number: "king",
        suit: "hearts"},
       {number: "ace",
        suit: "hearts"},
]





  function shuffle(deckOfCards) {
  var m = deckOfCards.length, t, i;
  while (m) {
    i = Math.floor(Math.random() * m--);
    t = deckOfCards[m];
    deckOfCards[m] = deckOfCards[i];
    deckOfCards[i] = t;
  }
  return deckOfCards;
}






//the game starts by taking an ante from everyone at the table.
function takeAnte() {
  for (var i = 0; i <= table.length-1; i++) {
      if (table[i].chipTotal > 0) {
        pot += 1;
        table[i].chipTotal -= 1;
        table[i].potContribution += 1;
        table[i].inCurrentGame = true;
      }
  }
}
// ante's are in folks... how many players do we have?


//now we know exactly how many cards are going to be needed for the whole game.
// standard is 1burn 4flop 5burn 6turn 7burn 8river + totalPlayersx2.
function arrangeCards() {
  var currentDeckOfCards = shuffle(deckOfCards);
  var cardsNeeded = (pot*2) + 8;

  for (var i = 0; i < cardsNeeded; i++) {
    nonGarbageCards.push(currentDeckOfCards[i]);
  }
  // Now we have the nonGarbageCards separated.
  // now we have to start after the dealerChip, deal 1 card out to each player
  // that has anted..
  // so I'd like to have a new array that was the dealing order of players
  // this wil stay useful for the entire game as it will be the order
  // of betting as well.
}

function determinePlayerOrder() {
  //get all players in the game onto the playerOrder variable
  for (var i = 0; i < table.length; i++) {
    if (table[i].inCurrentGame === true) {
      playerOrder.push(table[i].playerName);
    }}
  //figure out the dealer.
  for (var i = 0; i < table.length; i++) {
    if (table[i].dealerChip == true) {
      dealer.push(table[i].playerName);
      dealerSeatNumber = table[i].seatNumber;
    }}
  // now the playerOrderToDeal is tricky for me.
  // start with the player right after the dealer.
    for (var i = dealerSeatNumber; i < table.length; i++) {
  // if the player has a pot contribution equal to 1,
    if (table[i].potContribution == 1) {
  // add their seatNumber to playerOrderToDeal
  playerOrderToDeal.push(table[i].seatNumber)
}}
  // then start at seat1 and do the same until you hit the dealer.
  // at the end, the dealer should be the last and the player after the dealer should be the first.
  for (var i = 0; i < dealerSeatNumber; i++) {
    if (table[i].potContribution == 1) {
  // add their seatNumber to playerOrderToDeal
  playerOrderToDeal.push(table[i].seatNumber)
}}}

//now we need to deal the two hidden cards.
function dealTwoHiddenCards() {
  //go through the playerOrderToDeal array
  for (var i = 0; i < playerOrderToDeal.length; i++) {
    // make each players first card, the first nonGarbageCards you have
    table[i].firstCard = nonGarbageCards[i];
      // then delete that card from the available cards.
        nonGarbageCards.shift();
  }
// now do the same for the second card.
  for (var i = 0; i < playerOrderToDeal.length; i++) {
    table[i].secondCard = nonGarbageCards[i];
    nonGarbageCards.shift();
  }
}
//
//
//
//
//
//
//now lets run through the game..
takeAnte();
console.log('We have ' + pot + ' players total of a possible 10.');
arrangeCards();
determinePlayerOrder();
console.log('the players this round will be '+ playerOrder);
console.log('the dealer this round is ' + dealer);
console.log('the dealers seat number is ' + dealerSeatNumber);
console.log('so the actual dealing order will be seat numbers...' + playerOrderToDeal);
console.log('right now the nonGarbageCards are ...');
console.table(nonGarbageCards);
dealTwoHiddenCards();
console.log('now they are...');
console.table(nonGarbageCards);

</script>
  </body>
</html>
