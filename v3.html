<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Poker app from ScratchV2</title>
  </head>
  <body>
<canvas id="myCanvas" width="900" height="700" style="border:1px solid #000000; background-color: black;">
</canvas>




<script>
  console.log('app is running');


  function drawCircle(x, y, color) {
    canvas = document.getElementById('myCanvas');
    context = canvas.getContext('2d');
    centerX = canvas.width / x;
    centerY = canvas.height / y;
    radius = 30;
    context.beginPath();
    context.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);
    context.fillStyle = color;
    context.fill();
    context.lineWidth = 5;
    context.strokeStyle = '#003300';
    context.stroke();
    context.font = "30px Arial";
  }
  drawCircle(2, 1.2, 'green');//player1
  drawCircle(3, 1.29, 'red');//player2
  drawCircle(3.5, 1.7, 'blue');//player3
  drawCircle(3.5, 2.5, 'salmon');//player4
  drawCircle(3, 4, 'deeppink');//player5
  drawCircle(2, 5.2, 'purple');//player6
  drawCircle(1.5, 4, 'cornsilk');//player7
  drawCircle(1.4, 2.5, 'orange');//player8
  drawCircle(1.4, 1.7, 'yellow');//player9
  drawCircle(1.5, 1.29, 'white');//player10

     var dealer = [];
     var nonGarbageCards = [];
     var pot = 0;
     var playerOrder = [];
     var playerOrderToDeal = [];
     var dealerSeatNumber;
     var table = [
      {  seatNumber: 1,
         playerName: 'jim',
         chipTotal: 100,
         potContribution: 0,
         firstCard: undefined,
         secondCard: undefined,
         dealerChip: false,
         inCurrentGame: false},

      {  seatNumber: 2,
         playerName: 'alex',
         chipTotal: 100,
         potContribution: 0,
         firstCard: undefined,
         secondCard: undefined,
         dealerChip: true,
         inCurrentGame: false},

         {  seatNumber: 3,
            playerName: 'steve',
            chipTotal: 100,
            potContribution: 0,
            firstCard: undefined,
            secondCard: undefined,
            dealerChip: false,
            inCurrentGame: false},

            {  seatNumber: 4,
               playerName: 'gary',
               chipTotal: 100,
               potContribution: 0,
               firstCard: undefined,
               secondCard: undefined,
               dealerChip: false,
               inCurrentGame: false},

               {  seatNumber: 5,
                  playerName: 'david',
                  chipTotal: 100,
                  potContribution: 0,
                  firstCard: undefined,
                  secondCard: undefined,
                  dealerChip: false,
                  inCurrentGame: false},

                  {  seatNumber: 6,
                     playerName: 'josh',
                     chipTotal: 100,
                     potContribution: 0,
                     firstCard: undefined,
                     secondCard: undefined,
                     dealerChip: false,
                     inCurrentGame: false},

                     {  seatNumber: 7,
                        playerName: 'tommy',
                        chipTotal: 100,
                        potContribution: 0,
                        firstCard: undefined,
                        secondCard: undefined,
                        dealerChip: false,
                        inCurrentGame: false},

                        {  seatNumber: 8,
                           playerName: 'jerry',
                           chipTotal: 100,
                           potContribution: 0,
                           firstCard: undefined,
                           secondCard: undefined,
                           dealerChip: false,
                           inCurrentGame: false},

                           {  seatNumber: 9,
                              playerName: 'marsel',
                              chipTotal: 100,
                              potContribution: 0,
                              firstCard: undefined,
                              secondCard: undefined,
                              dealerChip: false,
                              inCurrentGame: false},

                              {  seatNumber: 10,
                                 playerName: "sally",
                                 chipTotal: 100,
                                 potContribution: 0,
                                 firstCard: undefined,
                                 secondCard: undefined,
                                 dealerChip: false,
                                 inCurrentGame: false},

     ]

  var deckOfCards = [
    {number: "2",
     suit: "diamonds"},
    {number: "3",
     suit: "diamonds"},
    {number: "4",
     suit: "diamonds"},
    {number: "5",
     suit: "diamonds"},
    {number: "6",
     suit: "diamonds"},
    {number: "7",
     suit: "diamonds"},
    {number: "8",
     suit: "diamonds"},
    {number: "9",
     suit: "diamonds"},
    {number: "10",
     suit: "diamonds"},
    {number: "jack",
     suit: "diamonds"},
    {number: "queen",
     suit: "diamonds"},
    {number: "king",
     suit: "diamonds"},
    {number: "ace",
     suit: "diamonds"},

     {number: "2",
      suit: "spades"},
     {number: "3",
      suit: "spades"},
     {number: "4",
      suit: "spades"},
     {number: "5",
      suit: "spades"},
     {number: "6",
      suit: "spades"},
     {number: "7",
      suit: "spades"},
     {number: "8",
      suit: "spades"},
     {number: "9",
      suit: "spades"},
     {number: "10",
      suit: "spades"},
     {number: "jack",
      suit: "spades"},
     {number: "queen",
      suit: "spades"},
     {number: "king",
      suit: "spades"},
     {number: "ace",
      suit: "spades"},

      {number: "2",
       suit: "clubs"},
      {number: "3",
       suit: "clubs"},
      {number: "4",
       suit: "clubs"},
      {number: "5",
       suit: "clubs"},
      {number: "6",
       suit: "clubs"},
      {number: "7",
       suit: "clubs"},
      {number: "8",
       suit: "clubs"},
      {number: "9",
       suit: "clubs"},
      {number: "10",
       suit: "clubs"},
      {number: "jack",
       suit: "clubs"},
      {number: "queen",
       suit: "clubs"},
      {number: "king",
       suit: "clubs"},
      {number: "ace",
       suit: "clubs"},

       {number: "2",
        suit: "hearts"},
       {number: "3",
        suit: "hearts"},
       {number: "4",
        suit: "hearts"},
       {number: "5",
        suit: "hearts"},
       {number: "6",
        suit: "hearts"},
       {number: "7",
        suit: "hearts"},
       {number: "8",
        suit: "hearts"},
       {number: "9",
        suit: "hearts"},
       {number: "10",
        suit: "hearts"},
       {number: "jack",
        suit: "hearts"},
       {number: "queen",
        suit: "hearts"},
       {number: "king",
        suit: "hearts"},
       {number: "ace",
        suit: "hearts"},
]





  function shuffle(deckOfCards) {
  var m = deckOfCards.length, t, i;
  while (m) {
    i = Math.floor(Math.random() * m--);
    t = deckOfCards[m];
    deckOfCards[m] = deckOfCards[i];
    deckOfCards[i] = t;
  }
  return deckOfCards;
}






//the game starts by taking an ante from everyone at the table.
function takeAnte() {
  for (var i = 0; i <= table.length-1; i++) {
      if (table[i].chipTotal > 0) {
        pot += 1;
        table[i].chipTotal -= 1;
        table[i].potContribution += 1;
        table[i].inCurrentGame = true;
      }
  }
}
//now we know exactly how many cards are going to be needed for the whole game.
// standard is 1burn 4flop 5burn 6turn 7burn 8river + totalPlayersx2.
function arrangeCards() {
  var currentDeckOfCards = shuffle(deckOfCards);
  var cardsNeeded = (pot*2) + 8;

  for (var i = 0; i <= cardsNeeded; i++) {
    nonGarbageCards.push(currentDeckOfCards[i]);
  }
  // Now we have the nonGarbageCards separated.
  // now we have to start after the dealerChip, deal 1 card out to each player
  // that has anted..
  // so I'd like to have a new array that was the dealing order of players
  // this wil stay useful for the entire game as it will be the order
  // of betting as well.
}

function determinePlayerOrder() {
  //get all players in the game onto the playerOrder variable
  for (var i = 0; i < table.length; i++) {
    if (table[i].inCurrentGame === true) {
      playerOrder.push(table[i].playerName);
    }}
  //figure out the dealer.
  for (var i = 0; i < table.length; i++) {
    if (table[i].dealerChip == true) {
      dealer.push(table[i].playerName);
      dealerSeatNumber = table[i].seatNumber;
    }}
  // now the playerOrderToDeal is tricky for me.
  // start with the player right after the dealer.
    for (var i = dealerSeatNumber; i < table.length; i++) {
  // if the player has a pot contribution equal to 1,
    if (table[i].potContribution == 1) {
  // add their seatNumber to playerOrderToDeal
  playerOrderToDeal.push(table[i].seatNumber)
}}
  // then start at seat1 and do the same until you hit the dealer.
  // at the end, the dealer should be the last and the player after the dealer should be the first.
  for (var i = 0; i < dealerSeatNumber; i++) {
    if (table[i].potContribution == 1) {
  // add their seatNumber to playerOrderToDeal
  playerOrderToDeal.push(table[i].seatNumber)
}}}

//now we need to deal the two hidden cards.
function dealTwoHiddenCards() {
  //go through the playerOrderToDeal array
  for (var i = 0; i < playerOrderToDeal.length; i++) {
    // make each players first card, the first nonGarbageCards you have
    table[i].firstCard = nonGarbageCards[i];
      // then delete that card from the available cards.
        nonGarbageCards.shift();
  }
// now do the same for the second card.
  for (var i = 0; i < playerOrderToDeal.length; i++) {
    table[i].secondCard = nonGarbageCards[i];
    nonGarbageCards.shift();
  }
}
//
//
//
//
//
//
//now lets run through the game..
takeAnte();
// console.log('We have ' + pot + ' players total of a possible 10.');
arrangeCards();
determinePlayerOrder();
// console.log('the players this round will be '+ playerOrder);
// console.log('the dealer this round is ' + dealer);
// console.log('the dealers seat number is ' + dealerSeatNumber);
// console.log('so the actual dealing order will be seat numbers...' + playerOrderToDeal);
// console.log('right now the nonGarbageCards are ...');
// console.table(nonGarbageCards);
dealTwoHiddenCards();
// console.log('now they are...');
// console.table(nonGarbageCards);
const firstCardXLocations = {
  0: 420,
  1: 190,
  2: 110,
  3: 70,
  4: 230,
  5: 430,
  6: 630,
  7: 680,
  8: 680,
  9: 630,

}
const firstCardYLocations = {
  0: 640,
  1: 600,
  2: 470,
  3: 290,
  4: 110,
  5: 60,
  6: 170,
  7: 300,
  8: 410,
  9: 550,
}

const secondCardXLocations = {
  0: 420,
  1: 190,
  2: 110,
  3: 70,
  4: 230,
  5: 430,
  6: 630,
  7: 680,
  8: 680,
  9: 630,

}
const secondCardYLocations = {
  0: 670,
  1: 630,
  2: 500,
  3: 320,
  4: 140,
  5: 90,
  6: 200,
  7: 330,
  8: 440,
  9: 580,
}

function drawHoleCards() {
  for (var i = 0; i <=playerOrderToDeal.length-1; i++) {
    context.fillText(table[i].firstCard.number + table[i].firstCard.suit,firstCardXLocations[i],firstCardYLocations[i]);
    context.fillText(table[i].secondCard.number + table[i].secondCard.suit,secondCardXLocations[i],secondCardYLocations[i]);
  }
}
drawHoleCards();

function drawNames() {
  context.font = '20pt Georgia';
  context.fillStyle = 'blue';
  for (var i = 0; i <=playerOrderToDeal.length-1; i++) {
  context.fillText(table[i].playerName, firstCardXLocations[i]-70, firstCardYLocations[i]);
}
}
drawNames();

function drawBlankCards(xStart, yStart, width, height, fillColor, strokeColor) {
  context.beginPath();
      context.rect(xStart, yStart, width, height);
      context.fillStyle = fillColor;
      context.fill();
      context.lineWidth = 4;
      context.strokeStyle = strokeColor;
      context.stroke();
}
drawBlankCards(420, 180, 50, 70, 'yellow', 'orange');//burn
drawBlankCards(340, 270, 50, 70, 'yellow', 'orange');//flop1
drawBlankCards(420, 270, 50, 70, 'yellow', 'orange');//flop2
drawBlankCards(500, 270, 50, 70, 'yellow', 'orange');//flop3
drawBlankCards(380, 360, 50, 70, 'yellow', 'orange');//burn
drawBlankCards(340, 450, 50, 70, 'yellow', 'orange');//turn
drawBlankCards(460, 360, 50, 70, 'yellow', 'orange');//burn
drawBlankCards(500, 450, 50, 70, 'yellow', 'orange');//river

function drawTotalPotContributions() {
  context.fillText('Pot Total ' + pot, 20, 30)
}
drawTotalPotContributions();

function drawFirstBurn() {
  context.font = '15 Calibri';
      context.fillStyle = 'red';
      context.fillText( nonGarbageCards[0].number, 420, 200);
      context.fillText( nonGarbageCards[0].suit, 420, 220);
}
drawFirstBurn();

function drawFlop() {
  context.font = '15 Calibri';
      context.fillStyle = 'red';
      context.fillText( nonGarbageCards[0].number, 330, 280);
      context.fillText( nonGarbageCards[0].suit, 330, 300);

      context.fillText( nonGarbageCards[1].number, 420, 320);
      context.fillText( nonGarbageCards[1].suit, 420, 340);

      context.fillText( nonGarbageCards[2].number, 520, 280);
      context.fillText( nonGarbageCards[2].suit, 520, 310);
}
drawFlop();

function drawSecondBurn() {
  context.fillText( nonGarbageCards[3].number, 350, 380);
  context.fillText( nonGarbageCards[3].suit, 350, 410);
}
drawSecondBurn();

function drawTurn() {
  context.fillText( nonGarbageCards[4].number, 480, 380);
  context.fillText( nonGarbageCards[4].suit, 480, 400);
}
drawTurn();

function drawThirdBurn() {
  context.fillText( nonGarbageCards[5].number, 350, 470);
  context.fillText( nonGarbageCards[5].suit, 350, 500);
}
drawThirdBurn();
function drawRiver() {
  context.fillText( nonGarbageCards[6].number, 520, 470);
  context.fillText( nonGarbageCards[6].suit, 520, 500);
}
drawRiver();







function drawStar(cx, cy, spikes, outerRadius, innerRadius) {
    var rot = Math.PI / 2 * 3;
    var x = cx;
    var y = cy;
    var step = Math.PI / spikes;

    context.strokeSyle = "#000";
    context.beginPath();
    context.moveTo(cx, cy - outerRadius)
    for (i = 0; i < spikes; i++) {
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        context.lineTo(x, y)
        rot += step

        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        context.lineTo(x, y)
        rot += step
    }
    context.lineTo(cx, cy - outerRadius)
    context.closePath();
    context.lineWidth=5;
    context.strokeStyle='blue';
    context.stroke();
    context.fillStyle='skyblue';
    context.fill();

}

function whereToDrawDealerChip() {
  for (var i = 0; i <= table.length-1; i++) {
    if (table[i].dealerChip === true) {
      drawStar(firstCardXLocations[i], firstCardYLocations[i]+50, 12, 15, 10);
    }}}
whereToDrawDealerChip();

function drawPlayerChipTotals() {
  context.fillStyle='aqua';
  for (var i = 0; i < table.length; i++) {
    context.fillText(table[i].chipTotal,firstCardXLocations[i],firstCardYLocations[i] + 60);
  }}
drawPlayerChipTotals();

//starting after the dealer, we ask everyone... check,bet, or fold
// function preFlopCheckBetOrFold() {
//   var playerOrderToDealCopy = playerOrderToDeal;
//   for (var i = 0; i < playerOrderToDealCopy.length; i++) {
//      console.log(table[playerOrderToDealCopy[i]-1].seatNumber);
//      var ask = prompt(table[playerOrderToDealCopy[i]-1].playerName + ' do you wanna CBorF');
//      if (ask === 'fold') {
//        table[playerOrderToDealCopy[i]-1].inCurrentGame = false;
//        context.fillStyle='red';
//        context.font = '40pt Georgia';
//        context.fillText('XXX', firstCardXLocations[playerOrderToDealCopy[i]-1], firstCardYLocations[playerOrderToDealCopy[i]-1]);
//        playerOrderToDeal[i] = 'X';
//         }
//       else if (ask === 'check'){}
//       else if (ask == 'bet') {
//         var betAmount = prompt('how much?');
//
//       }
//
//   }
// }
// preFlopCheckBetOrFold();

//ok this is where i'm stopping for now... This codebase has gotten too unweildy for me
//         // i've polluted the global space all to hell.
//         // there is nothing functional about my code..
//         // I'm surprised I made it this far..
//         // I need to bite off an easier project to start with.
// I should be writing more functionally
// I should be separating my code out into modules
// then there are all of the things i DONT KNOW that i don't know.
</script>
  </body>
</html>
